<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Lab</title>
  <link rel="stylesheet" type="text/css" href="../../lib/css/vu.css">
</head>
<body>
<div class="flex-col">
  <img id="src" alt="" src="./assets/windows_xp_bliss-wide.jpg"/>
  <canvas id="canvas"></canvas>
</div>
<script type="module">
  import Pixmap from './modules/ipjs/common/pixmap.js';
  import IPJs from './modules/ipjs/index.js';
  import GrayScale from './modules/ipjs/effects/gray-scale.js';
  import Invert from './modules/ipjs/effects/invert.js';
  import Channel from './modules/ipjs/common/channel.js'
  import Additive from './modules/ipjs/effects/additive.js';
  import BlackWhite from './modules/ipjs/effects/black-white.js';
  import WhiteNoise from './modules/ipjs/effects/white-noise.js';
  import Mosaic from './modules/ipjs/effects/mosaic.js';
  import GaussianBlur from './modules/ipjs/effects/gaussian-blur.js';
  import Tiktok from './modules/ipjs/effects/tiktok.js';
  import Histogram from './modules/ipjs/statistics/histogram.js';
  import Glitch from './modules/ipjs/effects/glitch.js';
  import PrimeNoise from './modules/ipjs/effects/primeNoise.js';
  
  window.onload = function() {
    const image = document.getElementById("src")
    const canvas = document.getElementById('canvas')
    canvas.width  = image.width;
    canvas.height = image.height;
    const context = canvas.getContext("2d");
    context.drawImage(image, 0, 0);
    const imageData = context.getImageData(0, 0, canvas.width, canvas.height)
    processImage(imageData)
    context.putImageData(imageData, 0, 0)
  }

  function processImage(imageData) {
    const pixmap = new Pixmap(imageData)
    // const histogram = new Histogram(pixmap)
    
    const ipjs = new IPJs()
    // ipjs.add(new Additive([
    //   { channel: Channel.R, value: 80 },
    //   { channel: Channel.G, value: 80 },
    //   { channel: Channel.B, value: -80 },
    // ]))
    // ipjs.add(new Additive([
    //   { channel: Channel.RGB, value: -80 },
    // ]))
    // ipjs.add(new GrayScale())
    // ipjs.add(new BlackWhite(128));
    // ipjs.add(new WhiteNoise(50))
    // ipjs.add(new Mosaic({ x: 300, y: 300, width: 200, height: 200}, 10))
    // ipjs.add(new GaussianBlur(2))
    // ipjs.add(new Tiktok(3))
    // ipjs.add(new Glitch())
    // ipjs.add(new PrimeNoise())
    ipjs.process(pixmap)
  }
</script>
</body>
</html>
